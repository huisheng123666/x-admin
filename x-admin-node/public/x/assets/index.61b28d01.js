var ce=Object.defineProperty,de=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var _e=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var H=(e,t,n)=>t in e?ce(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,B=(e,t)=>{for(var n in t||(t={}))_e.call(t,n)&&H(e,n,t[n]);if(J)for(var n of J(t))pe.call(t,n)&&H(e,n,t[n]);return e},G=(e,t)=>de(e,me(t));import{d as k,r as i,o as d,c as g,a as fe,E as R,b as I,u as c,w as u,e as m,n as N,t as $,f as b,g as T,F as O,h as P,i as f,j as a,k as K,l as C,m as W,p as Q,q as he,s as ve,B as ge,A as be,T as ye,v as Ee,x as we,y as X,z as ke,L as xe,C as Ae,D as Ie,G as $e,H as Ce,I as Le,J as Fe,N as Y,K as Ne,M as Oe,O as Pe}from"./vendor.1d842864.js";const Se=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}};Se();const De=k({setup(e){return(t,n)=>{const o=i("router-view");return d(),g(o)}}}),Ve="modulepreload",Z={},je="/x/",v=function(t,n){return!n||n.length===0?t():Promise.all(n.map(o=>{if(o=`${je}${o}`,o in Z)return;Z[o]=!0;const s=o.endsWith(".css"),r=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${r}`))return;const l=document.createElement("link");if(l.rel=s?"stylesheet":Ve,s||(l.as="script",l.crossOrigin=""),l.href=o,document.head.appendChild(l),s)return new Promise((h,_)=>{l.addEventListener("load",h),l.addEventListener("error",_)})})).then(()=>t())},Be=e=>Object.prototype.toString.call(e)==="[object Object]",Re=(e,t)=>{if(Be(t)||Array.isArray(t)){localStorage.setItem(e,JSON.stringify(t));return}localStorage.setItem(e,t)},ee=e=>{const t=localStorage.getItem(e);return t&&(t.indexOf("[")===0||t.indexOf("{")===0)?JSON.parse(t):t},Te=()=>{localStorage.clear()},y=fe.create({baseURL:"/api",timeout:8e3});y.interceptors.request.use(e=>{const t=ee("x_token");return e.headers=G(B({},e.headers),{Authorization:"Bearer token"}),t&&(e.headers.Authorization="Bearer "+t),e});y.interceptors.response.use(e=>{const{code:t,data:n,msg:o}=e.data;return t===200?n:t===50001?(R.error(o),oe.push("/login"),Promise.reject("token invalid")):(R.error(o||"\u7F51\u7EDC\u5F02\u5E38"),Promise.reject(o||"\u7F51\u7EDC\u5F02\u5E38"))},e=>(R.error(e.message||"\u7F51\u7EDC\u5F02\u5E38"),Promise.reject(e.message||"\u7F51\u7EDC\u5F02\u5E38")));var M=(e,t)=>{for(const[n,o]of t)e[n]=o;return e};const Me=f("\xA0 "),Ue=f("\xA0 "),ze=k({props:{menu:null},setup(e){const t=e,n=I(()=>t.menu.children?t.menu.children.filter(o=>o.menuType===1):[]);return(o,s)=>{const r=i("menu-item",!0),l=i("el-sub-menu"),h=i("el-menu-item");return c(n).length&&e.menu.menuState===1?(d(),g(l,{index:e.menu.path,key:e.menu.path},{title:u(()=>[m("i",{class:N([e.menu.icon,"menu-icon"])},null,2),Me,m("span",null,$(e.menu.menuName),1)]),default:u(()=>[(d(!0),b(O,null,T(e.menu.children,_=>(d(),g(r,{key:_.path,menu:_},null,8,["menu"]))),128))]),_:1},8,["index"])):e.menu.menuType===1&&e.menu.menuState===1?(d(),g(h,{index:e.menu.path,key:e.menu.path},{title:u(()=>[m("span",null,$(e.menu.menuName),1)]),default:u(()=>[e.menu.icon?(d(),b("i",{key:0,class:N([e.menu.icon,"menu-icon"])},null,2)):P("",!0),Ue]),_:1},8,["index"])):P("",!0)}}});var qe=M(ze,[["__scopeId","data-v-74f67502"]]);const Je=f("\u9996\u9875"),He=k({props:{list:null},setup(e){return(t,n)=>{const o=i("el-breadcrumb-item"),s=i("el-breadcrumb");return d(),g(s,{separator:"/"},{default:u(()=>[a(o,{to:{path:"/"}},{default:u(()=>[Je]),_:1}),(d(!0),b(O,null,T(e.list,r=>(d(),g(o,{key:r.name},{default:u(()=>[f($(r.name),1)]),_:2},1024))),128))]),_:1})}}}),U={"/":[]};let S=[];const Ge=(e,t)=>{if(U[t])return U[t];S=[];for(let n=0,o=e.length;n<o;n++)te(e[n],t);return S},te=(e,t,n=[])=>{if(t===e.path)S=[...n,{name:e.menuName}],U[t]=S;else if(e.menuType===1&&(n=[...n,{name:e.menuName}],e.children&&e.children.length))for(let o=0,s=e.children.length;o<s;o++)te(e.children[o],t,n)};const Ke={class:"basic-layout"},We=f("x"),Qe=f("-admin"),Xe={class:"nav-top"},Ye={class:"bread"},Ze={class:"user"},et=f("\u9000\u51FA"),tt={class:"wrapper"},nt=k({setup(e){const t=K(),n=C(!1);t.dispatch("getMenus").then(()=>{n.value=!0}),t.dispatch("getRoles");const o=W(),s=I(()=>t.state.userinfo||{}),r=C(!1),l=C(0),h=C(location.pathname.slice(2)),_=()=>{r.value=!r.value},F=p=>{p==="logout"&&(Te(),window.location.replace("/login"))},x=()=>{y.get("/leave/count").then(p=>{l.value=p})},A=I(()=>t.state.menus);Q(()=>{x()});const V=I(()=>A.value.length?Ge(A.value,o.path):[]);return he(o,()=>{h.value=o.path}),(p,E)=>{const re=i("el-menu"),j=i("el-icon"),ue=i("el-badge"),q=i("el-dropdown-item"),ae=i("el-dropdown-menu"),le=i("el-dropdown"),ie=i("router-view");return d(),b("div",Ke,[m("div",{class:N(["nav-slide",r.value?"collapse":""])},[m("h1",{onClick:E[0]||(E[0]=w=>p.$router.push("/")),class:"brand"},[We,r.value?P("",!0):(d(),b(O,{key:0},[Qe],64))]),a(re,{class:"nav-menu",router:"","background-color":"#001529","text-color":"#fff",collapse:r.value,"unique-opened":"","collapse-transition":!1,"default-active":h.value},{default:u(()=>[(d(!0),b(O,null,T(c(A),w=>(d(),g(qe,{menu:w,key:w.path},null,8,["menu"]))),128))]),_:1},8,["collapse","default-active"])],2),m("div",{class:N(["content-right",r.value?"collapse":""])},[m("div",Xe,[m("div",Ye,[a(j,{onClick:_,class:"menu-icon"},{default:u(()=>[a(c(ve))]),_:1}),a(He,{list:c(V)},null,8,["list"])]),m("div",Ze,[a(ue,{class:"notice","is-dot":!!l.value,onClick:E[1]||(E[1]=w=>p.$router.push("/audit/waiting"))},{default:u(()=>[a(j,null,{default:u(()=>[a(c(ge))]),_:1})]),_:1},8,["is-dot"]),a(le,{onCommand:F,trigger:"click"},{dropdown:u(()=>[a(ae,null,{default:u(()=>[a(q,{command:"email"},{default:u(()=>[f("\u90AE\u7BB1\uFF1A"+$(c(s).userEmail),1)]),_:1}),a(q,{command:"logout"},{default:u(()=>[et]),_:1})]),_:1})]),default:u(()=>[m("span",null,[f($(c(s).userName)+" ",1),a(j,{class:"el-icon--right"},{default:u(()=>[a(c(be))]),_:1})])]),_:1})])]),m("div",tt,[a(ie,{class:"router-content"},{default:u(({Component:w})=>[a(ye,{name:"fade-transform",mode:"out-in"},{default:u(()=>[n.value?(d(),g(Ee(w),{key:0})):P("",!0)]),_:2},1024)]),_:1})])],2)])}}});var ot=M(nt,[["__scopeId","data-v-6fad078b"]]);const ne=e=>(Ie("data-v-cec2efd0"),e=e(),$e(),e),st={class:"login-wrapper"},rt={class:"model"},ut=ne(()=>m("h4",{class:"title"},"x-admin",-1)),at=f("\u767B\u9646"),lt=ne(()=>m("div",{id:"login_bg"},null,-1)),it=k({setup(e){const t=we(),n=K(),o=X({userName:"admin",userPwd:"123456"}),s=X({userName:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:"blur"}],userPwd:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"}]}),r=C(),l=()=>{r.value.validate(h=>{h&&y.post("/users/login",B({},o)).then(_=>{n.commit("saveUserinfo",_),Re("x_token",_.token),t.replace("/")})})};return Q(()=>{window.particlesJS.load("login_bg","/particles.json",()=>{})}),(h,_)=>{const F=i("el-input"),x=i("el-form-item"),A=i("el-button"),V=i("el-form");return d(),b("div",st,[m("div",rt,[a(V,{model:c(o),rules:c(s),ref:(p,E)=>{E.loginForm=p,r.value=p},onSubmit:Ae(l,["prevent"])},{default:u(()=>[ut,a(x,{prop:"userName"},{default:u(()=>[a(F,{"prefix-icon":c(ke),modelValue:c(o).userName,"onUpdate:modelValue":_[0]||(_[0]=p=>c(o).userName=p)},null,8,["prefix-icon","modelValue"])]),_:1}),a(x,{prop:"password"},{default:u(()=>[a(F,{type:"password","prefix-icon":c(xe),modelValue:c(o).userPwd,"onUpdate:modelValue":_[1]||(_[1]=p=>c(o).userPwd=p)},null,8,["prefix-icon","modelValue"])]),_:1}),a(x,null,{default:u(()=>[a(A,{"native-type":"submit",class:"btn",type:"primary"},{default:u(()=>[at]),_:1})]),_:1})]),_:1},8,["model","rules","onSubmit"])]),lt])}}});var ct=M(it,[["__scopeId","data-v-cec2efd0"]]);const dt={class:"error-page"},mt={href:"/"},_t=f("\u56DE\u5230\u9996\u9875"),pt=k({setup(e){const t=W(),n=I(()=>{const o=t.query.status;return{title:o,subTitle:o==="500"?"\u670D\u52A1\u9519\u8BEF":o==="401"?"\u60A8\u6CA1\u6709\u6743\u9650\u8BBF\u95EE":"\u9875\u9762\u672A\u627E\u5230"}});return(o,s)=>{const r=i("el-button"),l=i("el-result");return d(),b("div",dt,[a(l,{icon:"error",title:c(n).title,"sub-title":c(n).subTitle},{extra:u(()=>[m("a",mt,[a(r,{type:"primary"},{default:u(()=>[_t]),_:1})])]),_:1},8,["title","sub-title"])])}}}),D=Ce({state(){return{userinfo:null,menus:[],roles:null,btns:{}}},mutations:{saveUserinfo(e,t){e.userinfo=t},changeMenus(e,t){e.menus=t},changeRoles(e,t=[]){const n={};t.forEach(o=>{n[o._id]=o}),e.roles={originVal:t,mapVal:n}},changeBtns(e,t){e.btns=t}},actions:{getMenus({commit:e}){return y.get("/menu/user").then(t=>{e("changeMenus",t.menus);const n={};t.btns.forEach(o=>{n[o.menuCode]=o}),e("changeBtns",n)})},getRoles({commit:e}){return y.get("/roles/all").then(t=>{e("changeRoles",t)})},getUserinfo({commit:e}){return y.get("/users/userinfo").then(t=>{e("saveUserinfo",t)})}}}),ft=[{path:"/",component:ot,children:[{path:"",component:()=>v(()=>import("./welcome.1525642d.js"),["assets/welcome.1525642d.js","assets/welcome.f4279348.css","assets/vendor.1d842864.js"])},{path:"system/user",component:()=>v(()=>import("./user.120c6620.js"),["assets/user.120c6620.js","assets/query-table.1b67047e.js","assets/vendor.1d842864.js"])},{path:"system/menu",component:()=>v(()=>import("./menu.f6b33e6c.js"),["assets/menu.f6b33e6c.js","assets/menu.72492b1d.css","assets/tree-select.eee251d0.js","assets/tree-select.9a2169b5.css","assets/vendor.1d842864.js","assets/query-table.1b67047e.js"])},{path:"system/roles",component:()=>v(()=>import("./roles.c2aa18d4.js"),["assets/roles.c2aa18d4.js","assets/roles.e0fe9a99.css","assets/query-table.1b67047e.js","assets/vendor.1d842864.js"])},{path:"system/dept",component:()=>v(()=>import("./dept.f04d5675.js"),["assets/dept.f04d5675.js","assets/query-table.1b67047e.js","assets/vendor.1d842864.js","assets/tree-select.eee251d0.js","assets/tree-select.9a2169b5.css"])},{path:"audit/holiday",component:()=>v(()=>import("./holiday.05179c62.js"),["assets/holiday.05179c62.js","assets/query-table.1b67047e.js","assets/vendor.1d842864.js"])},{path:"audit/waiting",component:()=>v(()=>import("./waiting.26346c1f.js"),["assets/waiting.26346c1f.js","assets/query-table.1b67047e.js","assets/vendor.1d842864.js"])},{path:"movie",component:()=>v(()=>import("./movie.d97ff979.js"),["assets/movie.d97ff979.js","assets/movie.e8962e5b.css","assets/query-table.1b67047e.js","assets/vendor.1d842864.js"])}]},{path:"/login",component:ct},{path:"/download",component:()=>v(()=>import("./download.ad19b1b3.js"),["assets/download.ad19b1b3.js","assets/download.8f4edf8f.css","assets/vendor.1d842864.js"])},{path:"/:pathMatch(.*)*",component:pt}],z=Le({history:Fe("/x"),routes:ft});z.beforeEach((e,t,n)=>{if(Y.start(),e.path==="/login"){n();return}if(ee("x_token")){if(D.state.userinfo){n();return}D.dispatch("getUserinfo").then(()=>{ht(e,n)}).catch(()=>{n("/login")})}else n("/login")});z.afterEach(()=>{Y.done()});function ht(e,t){e.path!=="/"&&e.path!=="/download"?y.post("/menu/check",{path:e.path}).then(n=>{n?t():t("/error?status=401")}).catch(n=>{t("/error?status=500")}):t()}var oe=z;const se={permission:{mounted(e,t){var o;t.value.some(s=>!!D.state.btns[s])||(o=e.parentNode)==null||o.removeChild(e)}}};const L=Ne(De);Object.keys(se).forEach(e=>{L.directive(e,se[e])});L.use(oe);L.use(D);L.use(Oe,{size:"small",locale:Pe});L.mount("#app");export{M as _,y as s};
