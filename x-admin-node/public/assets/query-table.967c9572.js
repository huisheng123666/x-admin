var b=Object.defineProperty;var N=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var h=(s,t,a)=>t in s?b(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,p=(s,t)=>{for(var a in t||(t={}))z.call(t,a)&&h(s,a,t[a]);if(N)for(var a of N(t))D.call(t,a)&&h(s,a,t[a]);return s};import{s as B}from"./index.93bbbaea.js";import{y as w,l as n,p as y,R as A}from"./vendor.68e615e1.js";function Q({form:s,formRef:t,url:a,deleteUrl:x="",tableRef:i}){const u=w({pageNum:1,pageSize:10,total:0}),v=n([]),r=n(!0),c=n([]),g=n(),m=n(!1),l=()=>{r.value=!0,B.get(a,{params:p(p({},s),u)}).then(({page:e,list:o})=>{u.pageNum=e.pageNum,u.pageSize=e.pageSize,u.total=e.total,i&&i.value&&(i.value.store.states.treeData.value={},i.value.store.states.lazyTreeNodeMap.value={}),v.value=o,r.value=!1}).catch(()=>{r.value=!1,u.pageNum>1&&(u.pageNum-=1)})},d=()=>{u.pageNum=1,l()},F=()=>{t.value.resetFields(),d()},L=e=>{u.pageNum=e,l()};return y(()=>{l()}),{resetForm:F,getList:l,page:u,tableData:v,tableLoading:r,changePage:L,filterTable:d,selectedList:c,selectionChange:e=>{c.value=e.map(o=>o.userId)},deleteRows:(e,o,T=!0,f)=>{A.confirm("\u786E\u8BA4\u5220\u9664\u5417\uFF1F","\u8B66\u544A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88"}).then(()=>{B.post(x,{[o]:e?T?[e]:e:c.value,action:"delete"}).then(()=>{f&&f(),l()})})},updateList:()=>{g.value=null,l()},editRow:g,dialogVisible:m,toggleDialog:(e,o=null)=>{m.value=e,g.value=o}}}export{Q as u};
